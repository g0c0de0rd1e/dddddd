# Админ панель TODO (`admin.neipix.com`)

## Реализация и модули
- [ ] Настроить систему ролей и защиту маршрутов (RBAC)
- [ ] Реализовать список пользователей с редактированием тарифов, баланса, статуса
- [ ] Создать инструменты impersonation и лог аудита действий админов
- [ ] Внедрить управление готовыми и внутренними нейросотрудниками
- [ ] Реализовать внутренний чат сотрудников и поддержку групповых чатов
- [ ] Настроить раздел оповещений (ручные и автоматические рассылки)
- [ ] Построить раздел отчетов с табами и выгрузкой в XLS/XLSX
- [ ] Реализовать интерфейс управления AI-провайдерами (ключи, приоритеты)

## API и бэкенд взаимодействие
- [ ] Добавить отдельные эндпоинты для админских операций (тарифы, блокировки)
- [ ] Настроить WebSocket/SSE для чатов и уведомлений в реальном времени
- [ ] Реализовать фильтры и сортировки серверной стороны для таблиц
- [ ] Подготовить сервис экспорта данных и загрузку больших выборок

## Тестирование
- [ ] Написать unit-тесты форм и таблиц (React Testing Library)
- [ ] Покрыть E2E сценарии: управление пользователями, оповещения, отчеты
- [ ] Добавить визуальные снепшоты для таблиц и модалок
- [ ] Настроить пермишен-тесты (проверка доступа для каждой роли)

## CLI и админ инструменты
- [ ] Реализовать команды массовых операций (`neipix-cli admin`) – рассылки, смена тарифов
- [ ] Добавить экспорт отчетов из CLI (CSV/Excel)
- [ ] Создать команду для генерации тестовых админов и данных для стенда

## Документация и процессы
- [ ] Подготовить admin-runbook (кейсы: блокировка, возврат, восстановление)
- [ ] Описать матрицу прав доступа по ролям и сценариям
- [ ] Сформировать чек-листы модерации и обработки тикетов поддержки
- [ ] Документировать процессы планирования и исполнения автоматических уведомлений

# Backend TODO (`api.neipix.com`)

## Реализация и бизнес-логика
- [x] Реализовать регистрацию и аутентификацию пользователей (JWT + refresh токены, remember me)
- [x] Настроить хранение refresh-токенов и отзыв сессий (logout)
- [x] Подготовить модуль конфигураций провайдеров с приоритезацией
- [x] Реализовать сервис биллинга (pix, токены, пересчет тарифов)
- [x] Добавить обработку расписаний и стоп-слов для нейросотрудников
- [x] Настроить Celery-воркеры для загрузки файлов и фоновых задач
- [x] Внедрить централизованную обработку ошибок и аудита действий
- [x] Реализовать управление ролями и разрешениями (RBAC)
- [x] Реализовать восстановление доступа (забытый пароль, сброс пароля)
- [x] Синхронизировать ORM-модели с актуальной схемой БД (assistants, chats, billing, analytics)
- [x] Добавить сервисный слой для управления нейросотрудниками
- [ ] Реализовать загрузку и хранение аватаров ассистентов/пользователей (S3, валидация форматов, удаление старых файлов)
- [ ] Добавить обновление метаданных файлов базы знаний (custom_instruction, статусы, размерные лимиты)
- [ ] Подготовить сервис тестового диалога ассистента для вкладки "Тестировать" (ограничение по токенам, логирование)

## API и интеграции
- [x] Реализовать /api/v1/auth (register, login, refresh, logout, me)
- [x] Завершить OpenAPI спецификацию с ответами и кодами ошибок
- [x] Добавить rate limiting и защита от повторных запросов
- [x] Реализовать вебхуки Робокассы и обработку ретраев
- [x] Подготовить интеграции с Telegram, amoCRM, Битрикс24
- [x] Реализовать базовые эндпоинты для /api/v1/integrations и конфигурации Telegram
- [x] Создать внутренний SDK (Python) для удобной работы с API
- [x] Реализовать forgot-password и reset-password API с почтовыми уведомлениями
- [x] Реализовать базовые CRUD эндпоинты для /api/v1/assistants
- [x] Добавить файлоприемник базы знаний ассистентов
- [x] Реализовать управление расписанием ассистентов
- [x] Реализовать базовые CRUD эндпоинты для /api/v1/chats и сообщений
- [x] Добавить внутренние чаты сотрудников и управление участниками
- [ ] Добавить эндпоинты PATCH для обновления метаданных файлов базы знаний и загрузки инструкций
- [ ] Реализовать выдачу подписей/эндпоинт для загрузки аватаров ассистентов и пользователей
- [ ] Подготовить ручку для тестового диалога с ассистентом (simulate) для клиентского UI

## CLI и инструменты
- [x] Разработать `neipix-cli backend` для миграций, сидов и админских задач
- [x] Добавить команду health-check для CI и мониторинга
- [x] Реализовать генератор тестовых данных (faker)
- [x] Подготовить скрипты для выгрузки логов и ручного биллинга

## Тестирование
- [x] Настроить pytest с разделением unit/integration тестов
- [x] Покрыть FastAPI эндпоинты контрактными тестами (schemathesis)
- [x] Реализовать тесты Celery задач с эмуляцией Redis
- [x] Добавить нагрузочные сценарии (k6/JMeter) для ключевых ручек
- [x] Включить stat analysis (mypy, ruff, bandit) в CI

## База данных
- [x] Сформировать ER-диаграмму и документацию связей
- [x] Написать Alembic миграции для всех сущностей и вспомогательных таблиц
- [x] Настроить индексы и ограничения по производительности и целостности
- [x] Реализовать архивирование истории сообщений и транзакций
- [x] Подготовить бэкап/restore скрипты и процедуры

## Документация и поддержка
- [x] Обновить README с инструкциями по запуску и профилированию
- [x] Создать runbook для дежурного инженера
- [x] Подготовить гайды по добавлению нового провайдера AI

# Frontend TODO (`app.neipix.com`)

## Реализация и функциональность
- [x] Настроить App Router с защитой маршрутов и редиректами
- [x] Реализовать дашборд с балансом, тарифами и событиями
- [x] Заполнить разделы "Готовые" и "Мои" нейросотрудники
- [x] Внедрить многошаговый мастер создания нейросотрудника (бот/анкета/ручной)
- [x] Добавить компонент чатов с поддержкой файлов, голоса и статусов ИИ/оператора
- [x] Реализовать раздел аналитики/отчетов с визуализациями и экспортом данных
- [x] Реализовать центр техподдержки с тикетами и встроенным чатом
- [ ] Реализовать страницу управления нейросотрудником с табами (инструкция, база знаний, расписание, настройки, интеграции, каналы, тестирование)
- [ ] Подключить мастер создания нейросотрудника к API (создание черновика, сохранение шага выбора каналов)
- [ ] Добавить drag-n-drop менеджер базы знаний с предпросмотром, ограничениями форматов и синхронизацией с API
- [ ] Реализовать загрузку и выбор аватаров для ассистентов и пользователя (интеграция со стореджем)
- [ ] Создать детальную страницу готового ассистента (просмотр доступных параметров, быстрый запуск тестового чата, кнопка "Подключить")
- [ ] Реализовать страницу профиля пользователя с редактированием ФИО, контактов и сменой пароля
- [ ] Настроить таб "Инструкция": формы промта, креативности, задержки ответа, генерация промта по описанию
- [ ] Настроить таб "База знаний": список файлов с поиском, кастомные инструкции, удаление, превью
 - [x] Настроить таб "Расписание": выбор часового пояса, рабочих дней и часов, статус онлайн/оффлайн
 - [x] Настроить таб "Дополнительные настройки": стоп-слова, флаг вмешательства человека, авто-возврат и параметры возврата
 - [x] Настроить таб "Интеграции": подключение/отключение каналов CRM, управление токенами, статусы соединения
 - [x] Настроить таб "Каналы": Telegram, виджет, API — пошаговые мастера подключения, проверка состояния
- [x] Настроить таб "Тестирование": тестовый чат с ассистентом, отображение токенов и стоимости, сброс истории
- [ ] Реализовать ограниченное редактирование полей для готовых ассистентов (в README выделены управляющие поля)

## API взаимодействие
- [x] Подготовить слой запросов (React Query/RTK Query) с типобезопасностью
- [x] Реализовать работу с WebSocket для реального времени по чатам
- [x] Настроить обработку ошибочных ответов и глобальные уведомления
- [x] Поддержать интеграцию с платежами (Робокасса) и подтверждениями
- [x] Создать мок-сервер/Storybook API для изолированной разработки
 - [x] Интегрировать API базы знаний ассистента (листинг, загрузка, удаление)
 - [x] Подключить API расписаний ассистента (CRUD) в интерфейсе настроек
- [ ] Встроить управление интеграциями и каналами через /api/v1/integrations и связанные ручки
- [ ] Добавить вызовы API для промтов (обновление настроек ассистента, генерация промта)
- [x] реализовать API отправки тестовых сообщений / симуляции диалога с ассистентом
- [ ] Подключить API обновления статусов ассистента (публикация, активация, стоп-слова)
- [ ] Синхронизировать мастер создания с эндпоинтом /api/v1/assistants (POST, PUT) и шагами интеграций

## Состояние и архитектура
 - [x] Определить модель данных и контексты Zustand/Redux
- [x] Настроить модульное разделение (features/shared/widgets)
- [x] Внедрить формовые утилиты (React Hook Form) и схемы валидации (zod/yup)
- [x] Создать систему токенов дизайна и утилиты Tailwind
- [ ] Настроить состояние и кэш для табов ассистента (React Query + Zustand, оптимистичные апдейты)
- [ ] Добавить хранение черновиков форм (autosave) при редактировании ассистента
- [ ] Ввести общий layout для страниц ассистента (хедер с метриками, CTA публикации, статусные бейджи)
- [ ] Добавить breadcrumb-навигацию и подсказки по каждому табу

## Тестирование
- [x] Написать unit-тесты компонентов и hooks (Vitest/Jest + RTL)
- [x] Добавить визуальные тесты Storybook (Chromatic/Playwright snapshot)
- [ ] Реализовать E2E сценарии (Cypress/Playwright) для входа, создания агента и оплаты
- [ ] Настроить accessibility проверки (axe/playwright)
- [ ] Обновить UI-kit описанием табов ассистента и сценариев работы с базой знаний
- [ ] Подготовить гайды по работе с drag-n-drop загрузкой и ограничениями файлов
- [ ] Зафиксировать UX сценарии подключения интеграций (step-by-step, состояния ошибок)

## CLI и девтуллинг
- [ ] Добавить генератор компонентов/состояния (Plop, Hygen)
- [ ] Настроить lint-staged и форматирование (ESLint, Prettier)
- [ ] Автоматизировать импорт и алиасы путей (tsconfig, eslint import)

## UI/UX документация
- [ ] Создать UI-kit и библиотеку компонентов в Storybook
- [ ] Описать юзер-флоу: onboarding, создание агента, управление балансом
- [ ] Подготовить контент-гайд по текстам и айдентике
- [ ] Документировать требования по доступности и состояниям элементов

